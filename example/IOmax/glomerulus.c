#include <math.h>
#include <stdio.h>

#include "autogen.h"
void ggj_init(struct ggj * self) {
    self->Cm = 2e-6*1e4;
    self->D_CA = 0.79e-9;
    self->D_CL = 2.08e-9;
    self->F = 96485;
    self->R = 8.314;
    self->T = 293;
    self->dend1_half_G_CL = 100;
    self->dend1_half_G_CA = 100;
    self->dend2_half_G_CL = 100;
    self->dend2_half_G_CA = 100;
    self->neck1_Gleak = 1.0e-8;
    self->neck2_Gleak = 1.0e-8;
    self->head1_tau_d = 0.255;
    self->head1_tau_r = 0.0050000000000000001;
    self->head1_gbar_gaba = 1.0000000000000001e-9;
    self->head1_tau_gaba0 = 0.029999999999999999;
    self->head1_eta_gaba = 0.034000000000000002;
    self->head1_theta_gaba = 0.0011999999999999999;
    self->head1_sigma_gaba = 6.0000000000000002e-5;
    self->head1_beta = 0.080000000000000002;
    self->head1_Kp = 0.00020000000000000001;
    self->head1_Ip = 0.00046999999999999999;
    self->head1_gamma = 0;
    self->head1_I_max = 30;
    self->head1_kK = 9;
    self->head1_kCL = 1;
    self->head1_Gleak = 1.0e-8;
    self->head1_n_Mg_out = 2;
    self->head1_gbar_nmda = 2.0000000000000001e-10;
    self->head1_tau_decay_nmda = 0.088999999999999996;
    self->head1_tau_rise_nmda = 0.0011999999999999999;
    self->head1_E_K_NA = 0.01;
    self->head1_E_head_ca = 0.01;
    self->head1_nTB = 0.10000000000000001;
    self->head1_kf = 1000000.0;
    self->head1_kb = 500;
    self->head2_tau_d = 0.255;
    self->head2_tau_r = 0.0050000000000000001;
    self->head2_gbar_gaba = 1.0000000000000001e-9;
    self->head2_tau_gaba0 = 0.029999999999999999;
    self->head2_eta_gaba = 0.034000000000000002;
    self->head2_theta_gaba = 0.0011999999999999999;
    self->head2_sigma_gaba = 6.0000000000000002e-5;
    self->head2_beta = 0.080000000000000002;
    self->head2_Kp = 0.00020000000000000001;
    self->head2_Ip = 0.00046999999999999999;
    self->head2_gamma = 0;
    self->head2_I_max = 30;
    self->head2_kK = 9;
    self->head2_kCL = 1;
    self->head2_Gleak = 1.0e-8;
    self->head2_n_Mg_out = 2;
    self->head2_gbar_nmda = 2.0000000000000001e-10;
    self->head2_tau_decay_nmda = 0.088999999999999996;
    self->head2_tau_rise_nmda = 0.0011999999999999999;
    self->head2_E_K_NA = 0.01;
    self->head2_E_head_ca = 0.01;
    self->head2_nTB = 0.10000000000000001;
    self->head2_kf = 1000000.0;
    self->head2_kb = 500;
    self->out_n_K = 3;
    self->out_n_CL = 134;
    self->out_n_CA = 2;
    self->neck1_V = -0.060999999999999999;
    self->neck1_diam = 9.9999999999999995e-8;
    self->neck1_length = 9.9999999999999995e-8;
    self->neck1_n_K = 85;
    self->neck1_n_CL = 5;
    self->neck1_n_CA = 10;
    self->head1_V = -0.060999999999999999;
    self->head1_diam = 9.9999999999999995e-8;
    self->head1_length = 9.9999999999999995e-8;
    self->head1_n_K = 85;
    self->head1_n_CL = 3.5;
    self->head1_n_CA = 10;
    self->head1_n_B = 0;
    self->head1_ggaba = 0;
    self->head1_ggap = 1.5e-11;
    self->head1_Y = 0;
    self->head1_X = 0;
    self->head1_ca_presyn = 0;
    self->neck2_V = -0.060999999999999999;
    self->neck2_diam = 9.9999999999999995e-8;
    self->neck2_length = 9.9999999999999995e-8;
    self->neck2_n_K = 85;
    self->neck2_n_CL = 5;
    self->neck2_n_CA = 10;
    self->head2_V = -0.060999999999999999;
    self->head2_diam = 9.9999999999999995e-8;
    self->head2_length = 9.9999999999999995e-8;
    self->head2_n_K = 85;
    self->head2_n_CL = 3.5;
    self->head2_n_CA = 10;
    self->head2_n_B = 0;
    self->head2_ggaba = 0;
    self->head2_ggap = 1.5e-11;
    self->head2_Y = 0;
    self->head2_X = 0;
    self->head2_ca_presyn = 0;
    self->dend1_V = -0.060999999999999999;
    self->dend1_diam = 9.9999999999999995e-7;
    self->dend1_length = 9.9999999999999995e-7;
    self->dend1_n_K = 85;
    self->dend1_n_CL = 15;
    self->dend1_n_CA = 15;
    self->dend2_V = -0.060999999999999999;
    self->dend2_diam = 9.9999999999999995e-7;
    self->dend2_length = 9.9999999999999995e-7;
    self->dend2_n_K = 85;
    self->dend2_n_CL = 15;
    self->dend2_n_CA = 15;
}
void ggj_timestep(struct ggj * self, double dt) {
    double x0 = 1.0/self->neck1_length;
    double x1 = 1.0/self->neck1_n_CA;
    double x2 = 1.0/self->F;
    double x3 = self->R*self->T;
    double x4 = x2*x3;
    double x5 = (1.0/2.0)*x4;
    double x6 = -self->dend1_V + self->neck1_V;
    double x7 = pow(self->neck1_diam, -2);
    double x8 = M_1_PI;
    double x9 = x3*x8/pow(self->F, 2);
    double x10 = self->neck1_length*x7*x9;
    double x11 = 0.5/self->D_CA;
    double x12 = x1*x10*x11;
    double x13 = -(x5*log(self->dend1_n_CA*x1) + x6)/(x12 + 1.0/self->dend1_half_G_CA);
    double x14 = 1.0/self->neck1_n_CL;
    double x15 = 2.0/self->D_CL;
    double x16 = x10*x14*x15;
    double x17 = -(-x4*log(self->dend1_n_CL*x14) + x6)/(x16 + 1.0/self->dend1_half_G_CL);
    double x18 = x13 + x17;
    double x19 = -self->neck1_V;
    double x20 = -self->head1_V;
    double x21 = self->neck1_V + x20;
    double x22 = 1.0/self->head1_n_CL;
    double x23 = pow(self->head1_diam, 2);
    double x24 = 1.0/x23;
    double x25 = self->head1_length*x24;
    double x26 = x15*x9;
    double x27 = x22*x25*x26;
    double x28 = 1.0/(x16 + x27);
    double x29 = self->neck1_Gleak*(x19 - x4*log(self->out_n_CL*x14)) - x28*(x21 - x4*log(self->head1_n_CL*x14));
    double x30 = 1.0/self->head1_n_CA;
    double x31 = x11*x9;
    double x32 = x25*x30*x31;
    double x33 = 1.0/(x12 + x32);
    double x34 = 2.5000000000000002e-20*self->F;
    double x35 = -x33*(x21 + x5*log(self->head1_n_CA*x1)) - x34*(self->neck1_n_CA - 5.0000000000000002e-5);
    double x36 = x8/self->Cm;
    double x37 = x2*x8;
    double x38 = 4*x37;
    double x39 = x0*x7;
    double x40 = 2*x37;
    double x41 = 1.0/self->head1_length;
    double x42 = self->head2_V + x20;
    double x43 = 1.0/self->head2_n_CL;
    double x44 = pow(self->head2_diam, 2);
    double x45 = 1.0/x44;
    double x46 = self->head2_length*x45;
    double x47 = x26*x43*x46;
    double x48 = 1.0/self->head2_ggap + 1.0/self->head1_ggap;
    double x49 = 1.0/(x27 + x47 + x48);
    double x50 = self->head1_V + x19;
    double x51 = 1.0/self->head1_kK;
    double x52 = 1.0/self->head1_kCL;
    double x53 = self->head1_n_CL*x52;
    double x54 = self->head1_n_K*x51;
    double x55 = self->out_n_CL*x52;
    double x56 = self->out_n_K*x51;
    double x57 = self->out_n_CL*self->out_n_K;
    double x58 = M_PI*self->head1_length;
    double x59 = self->head1_Gleak*(x20 - x4*log(self->out_n_CL*x22)) - self->head1_I_max*self->head1_diam*self->head1_kCL*x51*x58*(-self->head1_n_CL*self->head1_n_K + x57)/((x53 + 1)*(x54 + 1)*(x55*x56 + 1) + (x55 + 1)*(x56 + 1)*(x53*x54 + 1)) - x28*(-x4*log(self->neck1_n_CL*x22) + x50) + x42*x49;
    double x60 = 1.0/self->head2_n_CA;
    double x61 = x31*x46*x60;
    double x62 = 1.0/(x32 + x48 + x61);
    double x63 = -x33*(x5*log(self->neck1_n_CA*x30) + x50) - x34*(self->head1_n_CA - 5.0000000000000002e-5) + x42*x62;
    double x64 = x24*x41;
    double x65 = self->head1_kf*self->head1_n_B*self->head1_n_CA;
    double x66 = self->head1_kb*(self->head1_nTB - self->head1_n_B);
    double x67 = (1.0/2.0)*self->F;
    double x68 = pow(self->head1_ca_presyn, 2);
    double x69 = 1.0/self->neck2_length;
    double x70 = 1.0/self->neck2_n_CA;
    double x71 = -self->dend2_V + self->neck2_V;
    double x72 = pow(self->neck2_diam, -2);
    double x73 = self->neck2_length*x72;
    double x74 = x31*x70*x73;
    double x75 = -(x5*log(self->dend2_n_CA*x70) + x71)/(x74 + 1.0/self->dend2_half_G_CA);
    double x76 = 1.0/self->neck2_n_CL;
    double x77 = x26*x73*x76;
    double x78 = -(-x4*log(self->dend2_n_CL*x76) + x71)/(x77 + 1.0/self->dend2_half_G_CL);
    double x79 = x75 + x78;
    double x80 = -self->neck2_V;
    double x81 = -self->head2_V;
    double x82 = self->neck2_V + x81;
    double x83 = 1.0/(x47 + x77);
    double x84 = self->neck2_Gleak*(-x4*log(self->out_n_CL*x76) + x80) - x83*(-x4*log(self->head2_n_CL*x76) + x82);
    double x85 = 1.0/(x61 + x74);
    double x86 = -x34*(self->neck2_n_CA - 5.0000000000000002e-5) - x85*(x5*log(self->head2_n_CA*x70) + x82);
    double x87 = x69*x72;
    double x88 = 1.0/self->head2_length;
    double x89 = self->head1_V + x81;
    double x90 = self->head2_V + x80;
    double x91 = 1.0/self->head2_kK;
    double x92 = 1.0/self->head2_kCL;
    double x93 = self->head2_n_CL*x92;
    double x94 = self->head2_n_K*x91;
    double x95 = M_PI*self->head2_length;
    double x96 = self->head2_Gleak*(-x4*log(self->out_n_CL*x43) + x81) - self->head2_I_max*self->head2_diam*self->head2_kCL*x91*x95*(-self->head2_n_CL*self->head2_n_K + x57)/((x93 + 1)*(x94 + 1)*(x57*x91*x92 + 1) + (self->out_n_CL*x92 + 1)*(self->out_n_K*x91 + 1)*(x93*x94 + 1)) + x49*x89 - x83*(-x4*log(self->neck2_n_CL*x43) + x90);
    double x97 = -x34*(self->head2_n_CA - 5.0000000000000002e-5) + x62*x89 - x85*(x5*log(self->neck2_n_CA*x60) + x90);
    double x98 = x45*x88;
    double x99 = self->head2_kf*self->head2_n_B*self->head2_n_CA;
    double x100 = self->head2_kb*(self->head2_nTB - self->head2_n_B);
    double x101 = pow(self->head2_ca_presyn, 2);
    double grad_neck1_V = x0*x36*(x18 + x29 + x35)/self->neck1_diam;
    double grad_neck1_n_CL = -x38*x39*(x17 + x29);
    double grad_neck1_n_CA = x39*x40*(x13 + x35);
    double grad_head1_V = x36*x41*(x59 + x63)/self->head1_diam;
    double grad_head1_n_CL = -x38*x59*x64;
    double grad_head1_n_CA = x40*x64*(x23*x58*x67*(x65 - x66) + x63);
    double grad_head1_n_B = -2*x65 + 2*x66;
    double grad_head1_Y = -self->head1_Y/self->head1_tau_d;
    double grad_head1_X = (-self->head1_X - self->head1_Y + 1)/self->head1_tau_r;
    double grad_head1_ggaba = self->head1_Y*self->head1_gbar_gaba - self->head1_ggaba/(self->head1_eta_gaba/(exp((-self->head1_ca_presyn + self->head1_theta_gaba)/self->head1_sigma_gaba) + 1.0) + self->head1_tau_gaba0);
    double grad_head1_ca_presyn = self->head1_Ip - self->head1_beta*x68/(pow(self->head1_Kp, 2) + x68) + self->head1_gamma*log(2/self->head1_ca_presyn);
    double grad_neck2_V = x36*x69*(x79 + x84 + x86)/self->neck2_diam;
    double grad_neck2_n_CL = -x38*x87*(x78 + x84);
    double grad_neck2_n_CA = x40*x87*(x75 + x86);
    double grad_head2_V = x36*x88*(x96 + x97)/self->head2_diam;
    double grad_head2_n_CL = -x38*x96*x98;
    double grad_head2_n_CA = x40*x98*(x44*x67*x95*(-x100 + x99) + x97);
    double grad_head2_n_B = 2*x100 - 2*x99;
    double grad_head2_Y = -self->head2_Y/self->head2_tau_d;
    double grad_head2_X = (-self->head2_X - self->head2_Y + 1)/self->head2_tau_r;
    double grad_head2_ggaba = self->head2_Y*self->head2_gbar_gaba - self->head2_ggaba/(self->head2_eta_gaba/(exp((-self->head2_ca_presyn + self->head2_theta_gaba)/self->head2_sigma_gaba) + 1.0) + self->head2_tau_gaba0);
    double grad_head2_ca_presyn = self->head2_Ip - self->head2_beta*x101/(pow(self->head2_Kp, 2) + x101) + self->head2_gamma*log(2/self->head2_ca_presyn);
     self->I_inward_dend1 = x18;
     self->I_inward_dend2 = x79;
    self->neck1_V += dt * grad_neck1_V;
    self->neck1_n_CL += dt * grad_neck1_n_CL;
    self->neck1_n_CA += dt * grad_neck1_n_CA;
    self->head1_V += dt * grad_head1_V;
    self->head1_n_CL += dt * grad_head1_n_CL;
    self->head1_n_CA += dt * grad_head1_n_CA;
    self->head1_n_B += dt * grad_head1_n_B;
    self->head1_Y += dt * grad_head1_Y;
    self->head1_X += dt * grad_head1_X;
    self->head1_ggaba += dt * grad_head1_ggaba;
    self->head1_ca_presyn += dt * grad_head1_ca_presyn;
    self->neck2_V += dt * grad_neck2_V;
    self->neck2_n_CL += dt * grad_neck2_n_CL;
    self->neck2_n_CA += dt * grad_neck2_n_CA;
    self->head2_V += dt * grad_head2_V;
    self->head2_n_CL += dt * grad_head2_n_CL;
    self->head2_n_CA += dt * grad_head2_n_CA;
    self->head2_n_B += dt * grad_head2_n_B;
    self->head2_Y += dt * grad_head2_Y;
    self->head2_X += dt * grad_head2_X;
    self->head2_ggaba += dt * grad_head2_ggaba;
    self->head2_ca_presyn += dt * grad_head2_ca_presyn;
}
int example_main() {
    struct ggj ggj1;
    ggj_init(&ggj1);
    for (int j = 0; j < 10; j++) {
        for (long i = 0; i < 10*1000*1000; i++) {
            ggj_timestep(&ggj1, .1e-7);
        }
        printf("%f %f %f %f\n", ggj1.neck1_V, ggj1.head1_V, ggj1.head2_V, ggj1.neck1_V);
    }
}
    
